{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
{% endblock %}

{% block body_content %}

  <div class="row">
    <div class="col-md-11 offset-md-1">
      <div class="issue-description">
        <br>
          <h4> {{ issue.title }} </h4>
          <p> Project : <a href="{% url 'issues:project_details' issue.project.id %}"> {{ issue.project }}</a></p>
          <p> Description: </p>
          <p>{{ issue.summary }}</p>
          <div class="item-info">
            <p> {{ issue.issue_status }} &nbsp; &nbsp; &nbsp; {{ issue.priority }} </p>
          </div>
          <div class='item-dates'>
            <p> Owner: {{ issue.created_by }} -- Created on: {{ issue.created_on | date }}</p>
            <p> Last Updated by: {{ issue.modified_by }} -- {{ issue.modified_on | date }}</p>
          </div>
      </div>
    </div>
  </div>

  {% if user in issue.assigned_users.all %}
  <div class="row">
    <div class="col-md-3 offset-md-2">
      <a class="btn btn-info right mr-2" href="{% url 'issues:update_issue' issue.project.id %}">Update Issue</a>
    </div>
    <div class="col-md-3 offset-md-2">
      <form action="{% url 'issues:delete_issue' issue.id %}" method="post">
         {% csrf_token %}
         <input class="btn btn-info right mr-2" id='delete-btn' type="submit" value="Delete Issue" onclick="return confirm('Are you sure you want to delete this issue?')">
      </form>
    </div>

    <div class="col-md-3 offset-md-2">
      <a class="btn btn-info right mr-2" id="add-user">Add User</a>
      <div class="add-form">
        <form action="{% url 'issues:add_user_to_issue' issue.id %}" method='post'>
          {% csrf_token %}
          {{ user_form }}
          {% if user_form.errors %}
          {{ user_form.errors }}
          {% endif %}
          <button type="submit" class="btn btn-block mb-4" id="add-user-btn">Submit</button>
        </form>
      </div>
    </div>
    <div class="col-md-3 offset-md-2">
      <a class="btn btn-info right mr-2" id="remove-user">Remove User</a>
      <div class="remove-form">
        <form action="{% url 'issues:remove_user_from_issue' issue.id %}" method='post'>
          {% csrf_token %}
          {{ user_form }}
          {% if user_form.errors %}
          {{ user_form.errors }}
          {% endif %}
          <button type="submit" class="btn btn-block mb-4" id="remove-user-btn">Submit</button>
        </form>
      </div>
    </div>
  </div>

  <script src="{% static 'collapse.js' %}"></script>
  {% endif %}

{% endblock %}
